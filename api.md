# ğŸ›¡ï¸ Night Safety API (v1.0.0)

æä¾›ã€Œå¤œæ­¸å®‰å…¨ APPã€æŸ¥è©¢é™„è¿‘å®‰å…¨åº—å®¶èˆ‡å€åŸŸå®‰å…¨è©•ä¼°çš„ä»‹é¢ã€‚

Base URLï¼š
```
https://api.example.com
```

```
curl -X GET "https://api.example.com/safety-overview?lat=25.033964&lng=121.564468&radius_m=200" \
  -H "Accept: application/json"
```
---
## ğŸ§­ `GET /safety-overview`

### èªªæ˜
å–å¾—ç›®å‰å€åŸŸçš„æ•´é«”å®‰å…¨åˆ†æ•¸ï¼Œä¸¦é™„ä¸Šå®‰å…¨åº—å®¶æ‘˜è¦ã€‚

### Query åƒæ•¸
| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| `lat` | number | âœ… | ç·¯åº¦ |
| `lng` | number | âœ… | ç¶“åº¦ |
| `radius_m` | int | âŒ | æœå°‹åŠå¾‘ï¼ˆé è¨­ 200mï¼‰ |
| `limit` | int | âŒ | å›å‚³ç­†æ•¸ä¸Šé™ï¼ˆé è¨­ 20ï¼‰ |


---

### æˆåŠŸå›å‚³ç¯„ä¾‹
```json
{
  "meta": {
    "at": "2025-11-08T23:00:00+08:00",
    "center": { "lat": 25.033964, "lng": 121.564468 },
    "radius_m": 200,
    "tz": "Asia/Taipei"
  },
  "summary": {
    "label": "éœ€æ³¨æ„",
    "safety_score": 45,
    "analysis": {
      "safe_places": 12,
      "warning_zones": 3,
      "lighting_score": 0.8,
      "police_distance_m": 340,
      "last_incident_days": 47
    }
  },
  "places": [
    {
      "safety": 1,
      "type": "store",
      "name": "7-ELEVEN å¸‚åºœé–€å¸‚",
      "location": { "lat": 25.03452, "lng": 121.56501 },
      "distance_m": 65,
      "open_now": true,
      "phone": "+8862647392323",
      "hours": {
        "tz": "Asia/Taipei",
        "regular": [
          { "dow": "Mon", "open": "09:00", "close": "21:00" },
          { "dow": "Tue", "open": "09:00", "close": "21:00" },
          { "dow": "Wed", "open": "09:00", "close": "21:00" },
          { "dow": "Thu", "open": "09:00", "close": "21:00" },
          { "dow": "Fri", "open": "09:00", "close": "21:00" },
          { "dow": "Sat", "open": "10:00", "close": "18:40" },
          { "dow": "Sun", "open": "10:00", "close": "18:00" }
        ],
        "note": "Regular business hours"
      },
      "signals": ["well_lit", "crowded", "near_main_road", "safe_haven"]
    }
  ]
}
```

### å›å‚³æ¬„ä½èªªæ˜
| å€å¡Š | æ¬„ä½ | èªªæ˜ |
|------|------|------|
| `summary.analysis` | åˆ†æç´°ç¯€ï¼ˆç…§æ˜ã€äººæµã€è­¦å±€è·é›¢ç­‰ï¼‰ |
| `places[]` | å®‰å…¨åº—å®¶æ¸…å–® |

## é€šç”¨æ¬„ä½ï¼ˆæ‰€æœ‰ `type` å…±ç”¨ï¼‰
| æ¬„ä½ | å‹åˆ¥ | å¿…å¡« | èªªæ˜ |
|---|---|:--:|---|
| `type` | enum | âœ… | æ“šé»é¡å‹ï¼š`store`ï¼ˆåº—å®¶ï¼‰ã€`police`ï¼ˆè­¦å±€ï¼‰ã€`cctv`ï¼ˆå…¬å…±ç›£è¦–å™¨ï¼‰ã€`metro`ï¼ˆæ·é‹ç«™ï¼‰ |
| `safety` | int | âœ… | å®‰å…¨ä¿‚æ•¸ï¼š`1=å„ª`ã€`2=éœ€æ³¨æ„`ã€`3=å±éšª` |
| `name` | string | âœ… | é¡¯ç¤ºåç¨± |
| `location.lat` | number | âœ… | ç·¯åº¦ |
| `location.lng` | number | âœ… | ç¶“åº¦ |
| `open_now` | boolean | âœ… | æ˜¯å¦ã€Œæ­¤åˆ»ã€å¯æ±‚åŠ©ï¼å¯é€²å…¥ï¼ˆ`cctv` å›ºå®šå›å‚³ `true`ï¼‰ |
| `distance_m` | number | ï¼ | èˆ‡æŸ¥è©¢ä¸­å¿ƒè·é›¢ï¼ˆå…¬å°ºï¼‰ |
| `phone` | string\|null | ï¼ | é€£çµ¡é›»è©±ï¼ˆ`police` å¯ç‚º `110`/æ´¾å‡ºæ‰€é›»è©±ï¼‰ |
| `hours` | object | ï¼ | ç‡Ÿæ¥­ï¼å—ç†æ™‚é–“ï¼ˆè¦‹ä¸‹æ–¹ `hours` æ ¼å¼ï¼‰ |
| `signals[]` | string[] | ï¼ | å®‰å…¨è¨Šè™Ÿæ¨™ç±¤ï¼š`well_lit`, `cctv`, `crowded`, `near_main_road`, `safe_haven`â€¦ |


## ğŸ§­ `summary.safety_score` â€” å®‰å…¨ç­‰ç´šåŠƒåˆ†èªªæ˜

| è‹±æ–‡åç¨± | åˆ†æ•¸å€é–“ (`summary.safety_score`) | èªªæ˜ | å»ºè­° UI é¡è‰² | ç‹€æ…‹æç¤ºæ–‡å­— |
|:------------|:------------------:|:--------|:----------------:|:----------------|
| **Safe / Excellent** | **75 â€“ 100** | å€åŸŸæ˜äº®ã€äººæµç©©å®šï¼Œ24 hr åº—å®¶å¯†é›†ï¼›è­¦å±€ã€ä¾¿åˆ©å•†åº—ã€è—¥å±€è·é›¢è¿‘ã€‚ | ğŸŸ¢ ç¶ è‰² `#3CCF4E` | ã€Œæ­¤å€åŸŸå®‰å…¨ã€ |
| **Caution / Moderate Risk** | **35 â€“ 74** | å…‰ç·šæˆ–äººæµç•¥å°‘ï¼Œéƒ¨åˆ†æ™‚æ®µè¼ƒå®‰éœï¼›ä»æœ‰å¯æ±‚åŠ©æ“šé»ï¼ˆå¦‚è—¥å±€æˆ–å’–å•¡åº—ï¼‰ã€‚ | ğŸŸ¡ é»ƒè‰² `#FFC107` | ã€Œæ­¤å€éœ€ç•™æ„ï¼Œå»ºè­°çµä¼´æˆ–ç•™æ„å‘¨é­ã€ |
| **Danger / High Risk** | **0 â€“ 34** | å¤œé–“æ˜æš—ã€ç„¡æ˜é¡¯åº—å®¶æˆ–äººæµï¼›è·é›¢å®‰å…¨æ“šé»é æˆ–æ›¾æœ‰äº‹ä»¶ç´€éŒ„ã€‚ | ğŸ”´ ç´…è‰² `#FF5252` | ã€Œæ­¤å€å¤œé–“é¢¨éšªé«˜ï¼Œå»ºè­°é¿é–‹ã€ |



---

## ğŸš« éŒ¯èª¤å›å‚³æ ¼å¼
```json
{
  "error": "invalid_parameters",
  "message": "lat,lng are required"
}
```

| HTTP ç‹€æ…‹ | æ„ç¾© |
|------------|------|
| 400 | åƒæ•¸éŒ¯èª¤ |
| 401 | æœªæˆæ¬Šæˆ– Token éŒ¯èª¤ |
| 429 | è«‹æ±‚éå¤š |
| 500 | ä¼ºæœå™¨å…§éƒ¨éŒ¯èª¤ |

---

## ğŸ§° é–‹ç™¼è€…æç¤º
- è‹¥åªéœ€è¦ã€Œåœ°é»æ¸…å–®ã€â†’ `/safe-places`  
- è‹¥éœ€è¦ã€Œæ•´é«”å®‰å…¨åˆ†æ•¸ï¼‹æ¸…å–®ã€â†’ `/safety-overview`  
- æ‰€æœ‰æ™‚é–“ä»¥ `Asia/Taipei` ç‚ºä¸»